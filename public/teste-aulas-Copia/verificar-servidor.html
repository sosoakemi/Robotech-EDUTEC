<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verificar Servidor</title>
</head>
<body>
    <h1>üîç Verifica√ß√£o do Servidor RoboTech</h1>
    
    <div id="status">
        <h2>Status:</h2>
        <div id="resultado">Verificando...</div>
    </div>
    
    <button onclick="verificarServidor()">üîÑ Verificar Novamente</button>
    
    <div id="instrucoes" style="margin-top: 20px; padding: 20px; background: #f0f0f0; border-radius: 10px;">
        <h3>üìã Instru√ß√µes:</h3>
        <ol>
            <li><strong>Se voc√™ est√° testando LOCALMENTE:</strong>
                <ul>
                    <li>Abra o terminal na pasta "teste-aulas - Copia"</li>
                    <li>Execute: <code>npm install</code></li>
                    <li>Execute: <code>npm start</code></li>
                    <li>O servidor deve rodar em http://localhost:3000</li>
                </ul>
            </li>
            <li><strong>Se voc√™ est√° testando no VERCEL:</strong>
                <ul>
                    <li>Fa√ßa deploy no Vercel</li>
                    <li>Configure a vari√°vel GEMINI_API_KEY</li>
                    <li>Teste no dom√≠nio do Vercel</li>
                </ul>
            </li>
        </ol>
    </div>
    
    <script>
        async function verificarServidor() {
            const resultado = document.getElementById('resultado');
            resultado.innerHTML = 'Verificando...';
            
            // Testar se est√° em desenvolvimento ou produ√ß√£o
            const isLocal = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            
            if (isLocal) {
                resultado.innerHTML = `
                    <div style="color: orange;">
                        <h3>üè† Modo Local Detectado</h3>
                        <p>Voc√™ est√° testando localmente. Verificando se o servidor est√° rodando...</p>
                    </div>
                `;
                
                // Testar se o servidor est√° rodando
                try {
                    const response = await fetch('http://localhost:3000', {
                        method: 'GET',
                        mode: 'cors'
                    });
                    
                    if (response.ok) {
                        resultado.innerHTML = `
                            <div style="color: green;">
                                <h3>‚úÖ Servidor Local Funcionando!</h3>
                                <p>O servidor est√° rodando em http://localhost:3000</p>
                                <p>Status: ${response.status}</p>
                            </div>
                        `;
                    } else {
                        resultado.innerHTML = `
                            <div style="color: red;">
                                <h3>‚ùå Servidor Local com Problema</h3>
                                <p>Status: ${response.status}</p>
                                <p>Verifique se o servidor est√° rodando corretamente</p>
                            </div>
                        `;
                    }
                } catch (error) {
                    resultado.innerHTML = `
                        <div style="color: red;">
                            <h3>‚ùå Servidor Local N√£o Encontrado</h3>
                            <p>Erro: ${error.message}</p>
                            <p><strong>Solu√ß√£o:</strong> Execute <code>npm start</code> na pasta "teste-aulas - Copia"</p>
                        </div>
                    `;
                }
            } else {
                resultado.innerHTML = `
                    <div style="color: blue;">
                        <h3>üåê Modo Produ√ß√£o Detectado</h3>
                        <p>Voc√™ est√° testando em produ√ß√£o (Vercel).</p>
                        <p>URL atual: ${window.location.href}</p>
                    </div>
                `;
                
                // Testar API de produ√ß√£o
                try {
                    const response = await fetch('/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ 
                            message: 'teste',
                            sessionId: 'teste123'
                        })
                    });
                    
                    if (response.ok) {
                        resultado.innerHTML = `
                            <div style="color: green;">
                                <h3>‚úÖ API de Produ√ß√£o Funcionando!</h3>
                                <p>O chatbot est√° funcionando no Vercel</p>
                                <p>Status: ${response.status}</p>
                            </div>
                        `;
                    } else {
                        resultado.innerHTML = `
                            <div style="color: red;">
                                <h3>‚ùå API de Produ√ß√£o com Problema</h3>
                                <p>Status: ${response.status}</p>
                                <p>Verifique a configura√ß√£o do Vercel</p>
                            </div>
                        `;
                    }
                } catch (error) {
                    resultado.innerHTML = `
                        <div style="color: red;">
                            <h3>‚ùå API de Produ√ß√£o N√£o Funcionando</h3>
                            <p>Erro: ${error.message}</p>
                            <p><strong>Solu√ß√£o:</strong> Verifique o deploy no Vercel e as vari√°veis de ambiente</p>
                        </div>
                    `;
                }
            }
        }
        
        // Verificar automaticamente ao carregar
        window.addEventListener('load', verificarServidor);
    </script>
</body>
</html>
